{% comment %} {% extends "main_base.html" %}
{% block title %}{{ apartment.apt_name }}{% endblock title %}




{% block content %}


<br><b><br><br></b>

{% if not favorite %}
<form method="post" action="{% url 'favorite_create'  %}">

    {% csrf_token %}
    <input type="hidden" name='apartment' value='{{apartment.id}}'>
    <input type="hidden" name="next" value="{{ request.path }}">

    <!-- Add form fields here if necessary -->
    <button class="btn" type="submit">
        <h2 title="Add to favorite" class="bi bi-balloon-heart "></h2>
    </button>
</form>

{% endif %}
{% if favorite %}

<form method="post" action="{% url 'favorite_delete' favorite.id %}">
    {% csrf_token %}
    <input type="hidden" name="next" value="{{ request.path }}">

    <button class="btn" type="submit">
        <h2 title="Remove from favorite" class="bi bi-balloon-heart-fill"></h2>
    </button>
</form>
{% endif %}

<h1>{{ apartment.apt_name }}</h1>
<p class="lead"><strong>Description:</strong> {{ apartment.description }}</p>
<div class="row mb-4">
    <div class="col-md-6">
        <p><strong>Category:</strong> {{ apartment.category }}</p>
        <p><strong>Rooms:</strong> {{ apartment.rooms }}</p>
        <p><strong>Beds:</strong> {{ apartment.beds }}</p>
        {% if apartment.wifi %}
        <p><strong>Wifi:</strong> Yes</p>
        {% else %}
        <p><strong>Wifi:</strong> No</p>
        {% endif %}
        {% if apartment.tv %}
        <p><strong>TV:</strong> Yes</p>
        {% else %}
        <p><strong>TV:</strong> No</p>
        {% endif %}
    </div>
    <div class="col-md-6">
        <p><strong>City:</strong> {{ apartment.city }}</p>
        <p><strong>Country:</strong> {{ apartment.country }}</p>
    </div>
</div>
</div>

{{ apartment.city }};{{ apartment.country }}
<div class="col-md-4">
    {% if images %}
    <h2 class="mb-3">Images</h2>
    <div class="row">
        {% for apt_image in images %}
        <div class="col-md-6 mb-3">
            <img src="{{ apt_image.image.url }}" alt="house image" class="img-fluid rounded">
        </div>
        {% endfor %}
    </div>
    {% endif %}
</div>


{% if user.is_authenticated %}
{% include "../reservations/res_apt.html" %}
{% include "reviews/list_comment.html" %}
{% if add_comment %}
{% include "reviews/add_comment.html" %}

{% endif %}

{% else %}

<p class="lead">To book this apartment, please <a href="{% url " users_login" %}?next=/{{apartment.id}}"
        class="text-primary">log in</a> or <a href="{% url " users_register" %}" class="text-primary">sign up</a>.</p>


{% endif %}


{% endblock content %} {% endcomment %}



{% load static %}
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />


<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Details</title>
    <link rel="stylesheet" href="{% static 'css/detailsPage.css' %}" />
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" />
</head>

<body>

    <h1 class="text-center my-4">Apartment Details</h1>
    <div class="container">
        <!-- main description that was displayed in search results -->
        <!-- main description that was displayed in search results -->

        <!-- above pictures -->
        <div class="head d-flex justify-content-between mb-4">
            <div class="left-side-info d-flex flex-column justify-content-center align-items-center">
                <h4>{{apartment.price_per_night}}$</h4>
                {% if user.is_authenticated %}
                {% if not favorite %}
                <form method="post" action="{% url 'favorite_create'  %}">

                    {% csrf_token %}
                    <input type="hidden" name='apartment' value='{{apartment.id}}'>
                    <input type="hidden" name="next" value="{{ request.path }}">

                    <!-- Add form fields here if necessary -->
                    <button class="btn" type="submit">
                        <h2 title="Add to favorite" class="bi bi-balloon-heart "></h2>
                    </button>
                </form>

                {% endif %}
                {% if favorite %}

                <form method="post" action="{% url 'favorite_delete' favorite.id %}">
                    {% csrf_token %}
                    <input type="hidden" name="next" value="{{ request.path }}">

                    <button class="btn" type="submit">
                        <h2 title="Remove from favorite" class="bi bi-balloon-heart-fill"></h2>
                    </button>
                </form>
                {% endif %}
                {% endif %}
                <div class="p-2" id="stars">
                    <!-- Stars will be dynamically generated here -->
                </div>
                <div class="address">{{apartment.city}}, {{apartment.country}}</div>
            </div>

            <div class="right-side d-flex">
                <div class="position-relative m-1">
                    <i class="fa fa-calendar fa-2x tm-form-element-icon"></i>
                    <input type="text" placeholder="Check-in" onfocus="this.type='date'"
                        onblur="if(!this.value) this.type='text'" name="check-in"
                        class="form-control checkInDate text-center" id="inputCheckIn" value="Check In" />
                </div>
                <div class="position-relative m-1">
                    <i class="fa fa-calendar fa-2x tm-form-element-icon"></i>
                    <input type="text" placeholder="Check-out" onfocus="this.type='date'"
                        onblur="if(!this.value) this.type='text'" name="check-out"
                        class="form-control checkOutDate text-center" id="inputCheckOut" value="Check Out" />
                </div>
                <button type="submit" class="p-2 rounded myBtn m-1">Reserve</button>
            </div>
        </div>
        <!-- above pictures -->

        <!-- pictures -->
        <div class="imgs mb-5"></div>

        <!-- pictures -->
        <h5 class="description text-center">
           {{apartment.apt_name}}
        </h5>

        <p>
           {{apartment.description}}
        </p>
        <h4>{{ apartment.rooms }} rooms</h4>
        <h4>{{apartment.beds}} beds</h4>
        <!-- services and evaluation -->
        <div class="services">
            <div class="row">

                <div class="col-md-4 d-flex flex-column justify-content-center">
                    <div class="service">
                        <i class="service-icon fas fa-coffee"></i>
                        <span>Breakfast</span>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="service">
                        <i class="service-icon fas fa-user-check"></i>
                        <span>Express Check-in</span>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="service">
                        <i class="service-icon fas fa-wifi"></i>
                        <span>Free WiFi</span>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="service">
                        <i class="service-icon fas fa-concierge-bell"></i>
                        <span>Room Service</span>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="service">
                        <i class="service-icon fas fa-swimming-pool"></i>
                        <span>Swimming Pool</span>
                    </div>

                </div>
            </div>

        </div>


        <!-- map -->
        <!-- map -->
<div class="map">
    <iframe
        src="https://www.google.com/maps/embed/v1/place?key=yourapikey&q={{apartment.maps_link}}"
        width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"></iframe>
</div>
<!-- map -->

        <!-- map -->

        {% if add_comment %}




        <div class="evaluation d-flex flex-column align-items-center">
            <h4 class="m-0 rateText">Rate this apartment:</h4>
            <div class="rating mb-3">
                <form method="POST" action="{% url "comment"  apartment.id %}">
                    {% csrf_token %}
                    <input type="radio" id="star5" name="rating" value="5" />
                    <label for="star5"></label>
                    <input type="radio" id="star4" name="rating" value="4" />
                    <label for="star4"></label>
                    <input type="radio" id="star3" name="rating" value="3" />
                    <label for="star3"></label>
                    <input type="radio" id="star2" name="rating" value="2" />
                    <label for="star2"></label>
                    <input type="radio" id="star1" name="rating" value="1" />
                    <label for="star1"></label>
                    <input type="hidden" name="apartment" value="{{ apartment.id }}">
               
            </div>
            <textarea name="text" placeholder="Add a comment" class="mb-2 p-2"></textarea>
            <button type="Submit" class="p-2 rounded myBtn evalutaionBtn m-1">
                Submit
            </button>
         </form>
        </div>
        <!-- services and evaluation -->
{% endif %}
{% if user.is_authenticated %}
{% include "reviews/list_comment.html" %}

{% endif %}
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

       

    <script>
        const images = [
            {% for apt_image in images %}

        "{{ apt_image.image.url }}",


            {% if not forloop.last %}, {% endif %}
        {% endfor %}
        ];


        var bookedDates = [
            {% for date in booked_dates %}

        "{{date.check_in_date|date:"Y-m-d" }}",
        "{{date.check_out_date|date:"Y-m-d" }}",


            {% if not forloop.last %}, {% endif %}
        {% endfor %}
            
            ];

            const rating = 3;
    </script>










    <script src="{% static 'js/detailsPage.js' %}"></script>
</body>

</html>